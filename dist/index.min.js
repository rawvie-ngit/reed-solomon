const currentScript=globalThis.document&&globalThis.document.currentScript;!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports"],e)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.exports=e,this.memoryCache=null}static async fromCurrentDirectory(){if(currentScript){const e=currentScript.src.split("/").slice(0,-1).join("/");return r.fromResponse(fetch(`${e}/reed_solomon_erasure_bg.wasm`))}throw Error("Cannot read from fs")}static async fromResponse(e){const{instance:t}=await WebAssembly.instantiateStreaming(e);return new r(t.exports)}static fromBytes(e){const t=new WebAssembly.Module(e),_=new WebAssembly.Instance(t);return new r(_.exports)}encode(e,t,_){const n=this.exports,s=e.length,o=n.__wbindgen_malloc(s);this.getUint8Memory().set(e,o);const R=s/(t+_),i=n.encode(o,s,t,_);return i===r.RESULT_OK&&e.set(this.getUint8Memory().subarray(o+R*t,o+s),R*t),n.__wbindgen_free(o,s),i}reconstruct(e,t,_,n){const s=this.exports,o=e.length,R=s.__wbindgen_malloc(o);this.getUint8Memory().set(e,R);const i=n.length,c=s.__wbindgen_malloc(i);this.getUint8Memory().set(n.map(e=>e?1:0),c);const S=o/(t+_),E=s.reconstruct(R,o,t,_,c,i);return E===r.RESULT_OK&&e.set(this.getUint8Memory().subarray(R,R+S*t)),s.__wbindgen_free(R,o),s.__wbindgen_free(c,i),E}getUint8Memory(){let e=this.memoryCache;return null!==e&&e.buffer===this.exports.memory.buffer||(e=new Uint8Array(this.exports.memory.buffer),this.memoryCache=e),e}}t.ReedSolomonErasure=r,r.RESULT_OK=0,r.RESULT_ERROR_TOO_FEW_SHARDS=1,r.RESULT_ERROR_TOO_MANY_SHARDS=2,r.RESULT_ERROR_TOO_FEW_DATA_SHARDS=3,r.RESULT_ERROR_TOO_MANY_DATA_SHARDS=4,r.RESULT_ERROR_TOO_FEW_PARITY_SHARDS=5,r.RESULT_ERROR_TOO_MANY_PARITY_SHARDS=6,r.RESULT_ERROR_TOO_FEW_BUFFER_SHARDS=7,r.RESULT_ERROR_TOO_MANY_BUFFER_SHARDS=8,r.RESULT_ERROR_INCORRECT_SHARD_SIZE=9,r.RESULT_ERROR_TOO_FEW_SHARDS_PRESENT=10,r.RESULT_ERROR_EMPTY_SHARD=11,r.RESULT_ERROR_INVALID_SHARD_FLAGS=12,r.RESULT_ERROR_INVALID_INDEX=13}));
